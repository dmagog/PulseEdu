# Changelog

Все значимые изменения в проекте PulseEdu будут документироваться в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и проект следует [Semantic Versioning](https://semver.org/lang/ru/).

## [0.1.0] - 2025-09-08

### Добавлено

#### Основная функциональность
- **Система авторизации** с ролевой моделью (admin, data_operator, teacher, rop, student)
- **Импорт данных** из Excel файлов с валидацией и обработкой ошибок
- **Интерфейсы пользователей**:
  - Студент: просмотр прогресса, курсов, дедлайнов
  - Преподаватель: управление студентами, просмотр рисков
  - РОП: дашборды и аналитика
  - Администратор: настройки системы, мониторинг

#### LLM интеграция
- **Рекомендации для студентов** с использованием Yandex.Cloud LLM
- **Кеширование рекомендаций** для оптимизации производительности
- **Система оценок** рекомендаций (1-5 звезд)
- **Подтверждение рекомендаций** преподавателями

#### Мониторинг и аналитика
- **Система метрик** с автоматическим пересчетом прогресса
- **Кластеризация студентов** по успеваемости
- **Мониторинг LLM** с алертами и экспортом логов
- **Дашборды** с графиками и трендами

#### Уведомления
- **Email уведомления** через SMTP
- **Шаблоны писем** для различных событий
- **Интеграция с MailHog** для тестирования

#### Техническая архитектура
- **Многоворкерная схема Celery** с специализированными очередями
- **Миграции базы данных** через Alembic
- **Структурированное логирование** с request_id
- **Docker контейнеризация** всех сервисов

### Изменено

#### Улучшения производительности
- Оптимизированы запросы к базе данных
- Добавлено кеширование для LLM рекомендаций
- Улучшена обработка больших файлов импорта

#### Улучшения пользовательского интерфейса
- Обновлен дизайн с использованием Bootstrap
- Добавлена адаптивность для мобильных устройств
- Улучшена навигация между разделами

### Исправлено

#### Багфиксы
- Исправлены ошибки валидации данных при импорте
- Устранены проблемы с отображением дат
- Исправлены ошибки в системе ролей

#### Улучшения стабильности
- Добавлена обработка ошибок в LLM интеграции
- Улучшена обработка исключений в воркерах
- Добавлены таймауты для внешних сервисов

### Безопасность

#### Аутентификация и авторизация
- Реализована cookie-based аутентификация
- Добавлена проверка прав доступа на уровне роутеров
- Логирование всех попыток входа

#### Защита данных
- Валидация всех входных данных
- Санитизация HTML в рекомендациях
- Безопасное хранение паролей

### Документация

#### Создана полная документация
- **README.md** - инструкции по запуску и использованию
- **DevGuide** - руководство для разработчиков
- **API Reference** - справочник по API
- **Excel Mapping** - описание импорта данных
- **Deploy Guide** - руководство по развертыванию

### Технические детали

#### Зависимости
- Python 3.11+
- FastAPI 0.104+
- PostgreSQL 15+
- Celery 5.3+
- RabbitMQ 3.12+
- Docker 20.10+

#### Поддерживаемые форматы
- Excel файлы (.xlsx, .xls)
- CSV файлы
- JSON API

#### Интеграции
- Yandex.Cloud LLM API
- SMTP серверы
- MailHog (для разработки)

---

## [0.1.1] - 2025-09-08

### Добавлено

#### Улучшения интерфейса (I16: Interface Structure)
- **Главная страница** с приветствием и навигацией по ролям
- **Единая навигация** через базовый шаблон с группировкой меню
- **Детальная страница курса** с отображением контента, дат и событий
- **Статистика курсов** с показателями посещаемости и выполнения заданий

#### Расширенная админ-панель
- **Управление пользователями** - просмотр всех пользователей системы
- **Управление персоналом** - создание и редактирование административного персонала
- **Управление студентами** - просмотр и редактирование карточек студентов
- **Назначение курсов** - привязка курсов к преподавателям и РОП
- **Мониторинг LLM** - статистика и логи вызовов LLM с экспортом

#### Улучшения для преподавателей
- **Поддержка групп студентов** - отображение студентов по группам
- **Хронологическая структура курса** - временная шкала занятий и заданий
- **Дашборд кластеризации** - группировка студентов по зонам риска
- **Переупорядоченные блоки** - улучшенная структура интерфейса

#### Технические улучшения
- **Adminer** - веб-интерфейс для управления базой данных
- **Исправление таблиц LLM** - корректная работа мониторинга LLM
- **Улучшенная обработка ошибок** - более стабильная работа системы

### Исправлено
- Исправлена ошибка с отсутствующей таблицей `llm_call_logs`
- Улучшена обработка ошибок в шаблонах Jinja2
- Исправлены проблемы с отображением данных в админ-панели

---

## [0.1.3] - 2025-09-12

### Добавлено

#### Система тестирования и качества кода (I23: Тестирование)
- **Полный набор тестов** - 42 теста покрывают API, модели, сервисы и базовую функциональность
- **Тестирование моделей** - проверка создания и валидации всех основных моделей данных
- **Тестирование API** - проверка всех эндпоинтов для студентов, преподавателей, админов
- **Тестирование сервисов** - проверка бизнес-логики и интеграцийExtensions: Install from VSIX...
- **Изоляция тестов** - каждый тест использует отдельную базу данных в памяти
- **Фикстуры для тестирования** - переиспользуемые компоненты для тестов

#### CI/CD автоматизация (I24: CI/CD)
- **GitHub Actions workflows** - автоматизированные проверки качества кода
- **Двухуровневая система проверок**:
  - Quick Check - быстрые проверки для разработки (push/PR)
  - Full Test Suite - полные проверки для релизов (теги)
- **Проверки качества кода** - Black, isort, Flake8, MyPy, Bandit
- **Автоматическое тестирование** - pytest с покрытием кода
- **Неблокирующие линтеры** - предупреждения не останавливают развертывание
- **Локальные скрипты проверки** - `./scripts/quality_check.sh`

#### Автоматизированное развертывание (I22: Первичное развертывание)
- **Скрипт автоматического развертывания** - `./scripts/deploy.sh`
- **Инициализация базы данных** - автоматическое создание таблиц и индексов
- **Проверка готовности системы** - `scripts/health_check.py`
- **Валидация переменных окружения** - проверка всех необходимых настроек
- **Интеграция с docker-compose** - автоматический запуск всех сервисов
- **Поддержка тестовых данных** - `--with-test-data` флаг

#### Документация (I25: Документация)
- **Архитектурная диаграмма** - визуализация компонентов системы
- **Демонстрация интерфейса** - подробное описание всех разделов с скриншотами
- **План масштабирования** - стратегии горизонтального и вертикального роста
- **Дорожная карта** - направления развития без временных рамок
- **Ролевая модель** - описание возможностей каждой роли пользователей
- **GitHub Actions Workflows** - документация по CI/CD процессам
- **Улучшенный README** - структурированная навигация по документации

### Изменено

#### Улучшения качества кода
- **Исправлены ошибки тестов** - устранены проблемы с NOT NULL constraint
- **Оптимизированы импорты** - удалены неиспользуемые зависимости
- **Исправлены предупреждения линтеров** - улучшено качество кода
- **Обновлены скрипты** - исправлена команда python на python3

#### Улучшения документации
- **Реструктурирован README** - добавлена четкая навигация по разделам
- **Профессиональный стиль** - убран неформальный тон, добавлен деловой подход
- **Полное покрытие функционала** - документированы все возможности системы
- **Интеграция ролевой модели** - встроено описание прав доступа в UI демо

#### Улучшения CI/CD
- **Настроена стратегия проверок** - разные уровни для разработки и релизов
- **Неблокирующие линтеры** - предупреждения не препятствуют развертыванию
- **Локальная синхронизация** - скрипты проверки соответствуют GitHub Actions
- **Автоматизация релизов** - теги запускают полный цикл проверок

### Исправлено

#### Критические ошибки
- **NOT NULL constraint failed** - исправлены ошибки в тестах с ID студентов
- **Команда python не найдена** - заменена на python3 в скриптах
- **Дублирование CI/CD проверок** - устранено одновременное выполнение тестов
- **Проблемы с путями изображений** - исправлена кодировка для кириллицы в Markdown

#### Улучшения стабильности
- **Изоляция тестов** - каждый тест работает с отдельной БД
- **Обработка ошибок** - улучшена обработка исключений в скриптах
- **Валидация данных** - добавлены проверки переменных окружения

### Технические детали

#### Новые инструменты
- **pytest** - фреймворк для тестирования
- **pytest-asyncio** - поддержка асинхронных тестов
- **pytest-cov** - измерение покрытия кода
- **GitHub Actions** - автоматизация CI/CD
- **Bandit** - проверка безопасности кода

#### Новые файлы
- `tests/` - полная структура тестов
- `.github/workflows/` - автоматизация CI/CD
- `scripts/quality_check.sh` - локальные проверки
- `scripts/deploy.sh` - автоматическое развертывание
- `docs/ui_demo.md` - демонстрация интерфейса
- `docs/scaling.md` - план масштабирования
- `docs/roadmap.md` - дорожная карта

#### Обновленные файлы
- `README.md` - улучшенная структура и навигация
- `docker-compose.yml` - интеграция с init_db.py
- `env.example` - новые переменные окружения
- `.gitignore` - добавлены исключения для CI/CD

---

## [Unreleased]

### Планируется
- Hero-экраны для онбординга (I26)
- Многоязычная поддержка (RU/EN)
- Расширенная аналитика
- Мобильное приложение
- Интеграция с внешними LMS

---

## Формат версионирования

Проект использует [Semantic Versioning](https://semver.org/lang/ru/):

- **MAJOR** версия увеличивается при несовместимых изменениях API
- **MINOR** версия увеличивается при добавлении функциональности с обратной совместимостью
- **PATCH** версия увеличивается при исправлении ошибок с обратной совместимостью

## Типы изменений

- **Добавлено** - для новых функций
- **Изменено** - для изменений в существующей функциональности
- **Устарело** - для функций, которые скоро будут удалены
- **Удалено** - для удаленных функций
- **Исправлено** - для исправления ошибок
- **Безопасность** - для исправлений уязвимостей
