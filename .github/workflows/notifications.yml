name: Notifications

on:
  workflow_run:
    workflows: ["Tests", "Deploy"]
    types: [completed]

jobs:
  notify:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion != 'cancelled' }}
    
    steps:
    - name: Notify on test completion
      if: ${{ github.event.workflow_run.name == 'Tests' }}
      run: |
        if [ "${{ github.event.workflow_run.conclusion }}" = "success" ]; then
          echo "âœ… Tests passed successfully"
          echo "ğŸ” Workflow: ${{ github.event.workflow_run.name }}"
          echo "ğŸ“Š Repository: ${{ github.repository }}"
          echo "ğŸŒ¿ Branch: ${{ github.event.workflow_run.head_branch }}"
          echo "â° Completed: ${{ github.event.workflow_run.updated_at }}"
        else
          echo "âŒ Tests failed"
          echo "ğŸ” Workflow: ${{ github.event.workflow_run.name }}"
          echo "ğŸ“Š Repository: ${{ github.repository }}"
          echo "ğŸŒ¿ Branch: ${{ github.event.workflow_run.head_branch }}"
          echo "â° Failed: ${{ github.event.workflow_run.updated_at }}"
        fi
    
    - name: Notify on deployment completion
      if: ${{ github.event.workflow_run.name == 'Deploy' }}
      run: |
        if [ "${{ github.event.workflow_run.conclusion }}" = "success" ]; then
          echo "ğŸš€ Deployment completed successfully"
          echo "ğŸ” Workflow: ${{ github.event.workflow_run.name }}"
          echo "ğŸ“Š Repository: ${{ github.repository }}"
          echo "ğŸŒ¿ Branch: ${{ github.event.workflow_run.head_branch }}"
          echo "â° Deployed: ${{ github.event.workflow_run.updated_at }}"
        else
          echo "âŒ Deployment failed"
          echo "ğŸ” Workflow: ${{ github.event.workflow_run.name }}"
          echo "ğŸ“Š Repository: ${{ github.repository }}"
          echo "ğŸŒ¿ Branch: ${{ github.event.workflow_run.head_branch }}"
          echo "â° Failed: ${{ github.event.workflow_run.updated_at }}"
        fi
    
    - name: Summary
      run: |
        echo "ğŸ“‹ Notification Summary:"
        echo "  Workflow: ${{ github.event.workflow_run.name }}"
        echo "  Status: ${{ github.event.workflow_run.conclusion }}"
        echo "  Repository: ${{ github.repository }}"
        echo "  Branch: ${{ github.event.workflow_run.head_branch }}"
        echo "  Commit: ${{ github.event.workflow_run.head_sha }}"
        echo "  URL: ${{ github.event.workflow_run.html_url }}"
